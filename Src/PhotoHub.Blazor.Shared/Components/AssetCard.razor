@using MudBlazor
@using PhotoHub.Blazor.Shared.Models

<MudCard Elevation="2" Class="asset-card cursor-pointer" @onclick="@OnClick">
    <style>
        .asset-card {
            transition: transform 0.2s;
        }
        .asset-card:hover {
            transform: scale(1.02);
            z-index: 10;
        }
        .cursor-pointer {
            cursor: pointer;
        }
        .asset-thumbnail {
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background-color: var(--mud-palette-background-grey);
        }
        .asset-thumbnail img {
            max-width: 100%;
            max-height: 100%;
            object-fit: cover;
        }
    </style>
    <MudCardContent>
        <div class="asset-thumbnail">
            @if (Asset.HasThumbnails)
            {
                <img src="@Asset.ThumbnailUrl" alt="@Asset.FileName" loading="lazy" />
            }
            else
            {
                <MudIcon Icon="@GetAssetIcon(Asset.Type)" Size="Size.Large" />
            }
        </div>
        <MudText Typo="Typo.body2" Class="mt-2" Style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
            @Asset.FileName
        </MudText>
        <MudText Typo="Typo.caption" Class="text-secondary">
            @Asset.DisplayDate
        </MudText>
    </MudCardContent>
</MudCard>

@code {
    [Parameter] public TimelineItem Asset { get; set; } = null!;
    [Parameter] public EventCallback<TimelineItem> OnAssetClick { get; set; }

    private async Task OnClick()
    {
        await OnAssetClick.InvokeAsync(Asset);
    }

    private string GetAssetIcon(string type)
    {
        return type == "IMAGE" ? Icons.Material.Filled.Image : Icons.Material.Filled.VideoLibrary;
    }
}
